{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://jlee0368.github.io/Data_Visualisation_2/data/MyRTKnet_station_loc_cleaned.csv"
  },
  "title": {
    "text": "Number of MyRTKnet Stations by Receiver Type",
    "anchor": "middle",
    "fontSize": 20
  },
  "width": 500,
  "height": 500,
  "layer": [
    {
      "mark": {"type": "bar", "tooltip": true},
      "encoding": {
        "x": {
          "field": "Receiver Type",
          "type": "nominal",
          "axis": {"title": "Receiver Model", "grid": false, "titleFontSize": 12, "labelAngle": 0},
          "sort": "-y"
        },
        "y": {
          "aggregate": "count",
          "field": "Receiver Type",
          "type": "quantitative",
          "title": "Number of Stations",
          "axis": {
            "tickMinStep": 1,
            "format": "d",
            "grid": false,
            "titleFontSize": 12
          }
        },
        "color": {
          "field": "Receiver Type",
          "type": "nominal",
          "title": "Receiver Type",
          "scale": {
          "domain": ["TRIMBLE NETR5", "LEICA GR25", "TRIMBLE NETR9", "LEICA GR50"],
          "range": ["#0072B2", "#E69F00", "#009E73", "#CC79A7"]
        },
          "legend": null
        },
        "tooltip": [
          {"field": "Receiver Type", "title": "Receiver Model"},
          {"aggregate": "count", "title": "Total Stations", "format": ","}
        ]
      }
    },
    
    {
      "data": { "values": [
        {"model": "TRIMBLE NETR5", "x_data_start": "TRIMBLE NETR9", "y_data_start": 40, "x_text": "TRIMBLE NETR9", "y_text": 40, "text": ["Top two models",  "account for", "> 95% of the network"]},
        {"model": "TRIMBLE NETR9", "x_data_start": "LEICA GR50", "y_data_start": 7, "x_text": "LEICA GR50", "y_text": 7, "text": ["Bottom two models", "have a", "negligible presence"]}
      ]},
      "layer": [
        {
          "mark": { "type": "rule", "strokeDash": [4, 2], "opacity": 0.8, "stroke": "black" },
          "encoding": {
            "x": {
              "field": "x_data_start",
              "type": "nominal",
              "band": 0.5,
              "sort": {"op": "count", "field": "Receiver Type", "order": "descending"}
            },
            "x2": {
              "field": "x_text",
              "type": "nominal",
              "band": 0.5,
              "sort": {"op": "count", "field": "Receiver Type", "order": "descending"}
            },
            "y": {"field": "y_data_start", "type": "quantitative"},
            "y2": {"field": "y_text", "type": "quantitative"}
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontWeight": "bold",
            "fontSize": 12,
            "color": "black",
            "opacity": 0.9,
            "dy": -5
          },
          "transform": [{"filter": "datum.model === 'TRIMBLE NETR5'"}],
          "encoding": {
            "x": {
              "field": "x_text",
              "type": "nominal",
              "band": 0.5,
              "sort": {"op": "count", "field": "Receiver Type", "order": "descending"}
            },
            "y": {"field": "y_text", "type": "quantitative"},
            "text": {"field": "text"}
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontWeight": "bold",
            "fontSize": 12,
            "color": "black",
            "opacity": 0.9,
            "dy": -5
          },
          "transform": [{"filter": "datum.model === 'TRIMBLE NETR9'"}],
          "encoding": {
            "x": {
              "field": "x_text",
              "type": "nominal",
              "band": 0.5,
              "sort": {"op": "count", "field": "Receiver Type", "order": "descending"}
            },
            "y": {"field": "y_text", "type": "quantitative"},
            "text": {"field": "text"}
          }
        }
      ]
    }
  ]
}