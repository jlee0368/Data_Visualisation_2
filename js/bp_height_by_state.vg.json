{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://jlee0368.github.io/Data_Visualisation_2/data/MyRTKnet_station_loc_cleaned.csv"
  },
  "transform": [
    { "calculate": "toNumber(trim(datum['Height in meter']))", "as": "height_m" },
    { "filter": "!isNaN(datum.height_m)" }
  ],
  "layer": [

    {
      "mark": { "type": "boxplot", "extent": "min-max", "outliers": true, "size": 18 },
      "encoding": {
        "x": { "field": "height_m", "type": "quantitative", "title": "Station Height (m)", "axis" : {"titleFontSize": 12, "grid": false}},
        "y": {
          "field": "State",
          "type": "nominal",
          "title": "State",
          "sort": { "op": "median", "field": "height_m", "order": "descending" },
          "axis" : {"titleFontSize": 12}
        },
        "color": { "field": "State", "type": "nominal", "legend": null }
      }
    },
    
    {
      "transform": [
        {
          "aggregate": [
            { "op": "min",    "field": "height_m", "as": "min" },
            { "op": "q1",     "field": "height_m", "as": "q1" },
            { "op": "median", "field": "height_m", "as": "median" },
            { "op": "q3",     "field": "height_m", "as": "q3" },
            { "op": "max",    "field": "height_m", "as": "max" }
          ],
          "groupby": ["State"]
        }
      ],
      "mark": { "type": "point", "opacity": 0 }, 
      "encoding": {
        "y": { "field": "State", "type": "nominal" },
        "x": { "field": "median", "type": "quantitative" },  
        "tooltip": [
          { "field": "State",  "type": "nominal",       "title": "State" },
          { "field": "min",    "type": "quantitative",  "title": "Min Height (m)", "format": ".2f" },
          { "field": "q1",     "type": "quantitative",  "title": "25th Percentile (m)", "format": ".2f" },
          { "field": "median", "type": "quantitative",  "title": "Median Height (m)", "format": ".2f" },
          { "field": "q3",     "type": "quantitative",  "title": "75th Percentile (m)", "format": ".2f" },
          { "field": "max",    "type": "quantitative",  "title": "Max Height (m)", "format": ".2f" }
        ]
      }
    },
    
  
    {
      "data": { "values": [
       
        {"State": "Pahang", "x_data_start": 1110, "y_data_start_band": 0.5, "x_text_target": 900, "y_text_target_state": "Kelantan", "y_text_target_band": 0.5, "text": "Highest Max Elevation"},
    
        {"State": "Sabah", "x_data_start": 150, "y_data_start_band": 0.5, "x_text_target": 600, "y_text_target_state": "Sarawak", "y_text_target_band": 0.5, "text": "Highest Median Elevation"}
     
      ]},
      "layer": [
   
        {
          "mark": { "type": "rule", "strokeDash": [7, 7], "opacity": 0.8, "stroke": "black" },
          "encoding": {
            "x": {"field": "x_data_start", "type": "quantitative"},
            "x2": {"field": "x_text_target", "type": "quantitative"},
            "y": {"field": "State", "type": "nominal", "band": {"field": "y_data_start_band"}},
            "y2": {"field": "y_text_target_state", "type": "nominal", "band": {"field": "y_text_target_band"}}
          }
        },
   
        {
          "mark": {
            "type": "text",
            "align": "right",
            "baseline": "middle",
            "fontWeight": "bold",
            "fontSize": 14,
            "color": "black",
            "opacity": 0.9,
            "dx": 5
          },
          "transform": [{"filter": "datum.State === 'Pahang'"}],
          "encoding": {
            "x": {"field": "x_text_target", "type": "quantitative"},
            "y": {"field": "y_text_target_state", "type": "nominal", "band": {"field": "y_text_target_band"}},
            "text": {"field": "text"}
          }
        },
  
        {
          "mark": {
            "type": "text",
            "align": "left",
            "baseline": "middle",
            "fontWeight": "bold",
            "fontSize": 14,
            "color": "black",
            "opacity": 0.9,
            "dx": 5
          },
          "transform": [{"filter": "datum.State === 'Sabah'"}],
          "encoding": {
            "x": {"field": "x_text_target", "type": "quantitative"},
            "y": {"field": "y_text_target_state", "type": "nominal", "band": {"field": "y_text_target_band"}},
            "text": {"field": "text"}
          }
        },
       
        {
          "mark": {
            "type": "text",
            "align": "left",
            "baseline": "middle",
            "fontWeight": "bold",
            "fontSize": 14,
            "color": "black",
            "opacity": 0.9,
            "dx": 5
          },
          "transform": [{"filter": "datum.State === 'Labuan'"}],
          "encoding": {
            "x": {"field": "x_text_target", "type": "quantitative"},
            "y": {"field": "y_text_target_state", "type": "nominal", "band": {"field": "y_text_target_band"}},
            "text": {"field": "text"}
          }
        }
      ]
    }
  ],
  "title": {"text": "Distribution of MyRTKnet Station Heights", "fontSize": 24},
  "width": 450,
  "height": 400,
  "config": { "view": { "stroke": null } }
}